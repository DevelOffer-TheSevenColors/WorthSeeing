<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity5">

<head th:replace="/fragments/header :: head">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
</head>
<style>
.leftcolumn {
	float: left;
}
.topnav {
	overflow: hidden;
	background-color: #333;
}

.topnav a {
	float: left;
	display: block;
	color: #f2f2f2;
	text-align: center;
	padding: 14px 16px;
	text-decoration: none;
}

.topnav a:hover {
	background-color: #ddd;
	color: black;
}
</style>
<body>
	<div>
		<th:block th:replace="/fragments/header :: TopbarFragment"></th:block>

		<div class="container-fluid py-5">
			<div class="container pt-5 pb-3">

				<div class="topnav">
					<a href="/mypageMain">My Page</a> 
					<a href="/main">Main Page</a>
				</div>

				<div class="leftcolumn">
					<div>

						<h2>내 정보</h2>

						<div>
							<span><img src="bb.gif" width="120px" height="120px"></span>
						</div>

						<div>
							<table>
								<tr>
									<th colspan="2"><span sec:authentication="principal.users.name"></span></th>
									<td>님</td>
								</tr>
								<tr>
									<th>보유포인트 :</th>
									<td th:text="${users.point}"></td>
									<td>Point</td>
								</tr>
								<tr>
									<th>오늘 활동횟수 :</th>
									<td th:text="${users.dailyClick}"></td>
									<td>Click</td>
								</tr>
							</table>
						</div>

						<p>
							<button type="button">개인정보 수정</button>
						</p>

					</div>

					<div>
						<hr>
						<div>
							<a href="/logout">로그아웃</a>
						</div>
						<hr>
						<button class="domainBtn"  id="mypageCouponMall">포인트몰</button>
						<hr>
						<div>포인트 사용내역</div>
						<button class="domainBtn"  id="mypagePointHistory">포인트 사용내역</button>
						<hr>
						<div>경매내역</div>
						<button class="domainBtn" id="mypageAuctionHistory">경매내역</button>
						<hr>
						<div>구매내역</div>
						<button class="domainBtn" id="mypagePurchaseHistory">구매내역</button>

					</div>
				</div>
				
				<div>
					<div class="menuItem">
						<div class="card">
							<h2>포인트 몰</h2>
						</div>
						<div>
							<button onclick="location.href='/mypageMain';">현재 이용중인 서비스 현황</button>
							<button onclick="location.href='/mypageMain';">경매 예약 현황</button>
							<br />
							<table border="1"
								th:each="blockGroup, state : ${BlockGroupUserId}">
								<tr align="center">
									<th scope="col">보유한 블럭그룹(Img)</th>
									<th scope="col">블록 번호 :</th>
									<th scope="col">전체 방문자 수 :</th>
									<th scope="col">종료 일자 :</th>
								</tr>
								<tr align="center">
									<td>이미지뷰</td>
									<td th:text="${blockGroup.blockGroup_seq}"></td>
									<td th:text="${blockGroup.clickCnt}"></td>
									<td th:text="${blockGroup.endDate}"></td>
								</tr>
							</table>

						</div>
					</div>
				</div>

			</div>
		</div>
		</div>

		<th:block th:replace="/fragments/footer :: footerFragment"></th:block>
	
	<!-- 	MyPage 우측화면 동적변환 -->
	<script>
		function movePage(domain) {
			var ajaxOption = {
				url : "/" + domain,
				async : true,
				type : "GET",
				dataType : "html",
				cache : false,
			};

			$.ajax(ajaxOption).done(function(data) {
				// rightcolumn 영역 삭제
				$('.menuItem').children().remove();
				// rightcolumn 영역 교체
				$('.menuItem').html(data);
			});
		}

		$(".domainBtn").click(function() {
			idDomain = $(this).attr('id');
			movePage(idDomain);
		})
		
	</script>


</body>
</html>