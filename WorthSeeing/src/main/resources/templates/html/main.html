<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity5">

<head th:replace="/fragments/header :: head">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
</head>

<body>
	<style>
.blockTest {
	position: relative;
	z-index: 1;
}

.tt {
	border: 1px solid black;
	position: absolute;
	width: 100px;
	height: 100px;
	background-color: yellow;
}

.tt img {
	width: 100%;
	height: 100%;
}
</style>
	<script>
function createBlock(number) {
		
		// Block cnt && User Daily Click
		$("#" + number).click(function() {
			setLocalStorage($("#userName").text(), number);
		});
		
		// 현재페이지에서 1클릭씩 증가하는 변수 생성하여 10이되면 알림창 띄우게..

		if (number % 17 == 0) {
			$("#" + number).css('margin-left', 1700 + 'px');
		} else {
			$("#" + number).css('margin-left', 100 * (number % 17) + 'px');
		}

	}
	
	var set = new Set();
	
	function setLocalStorage(key, number) {
		set.add(number); // 중복없이 사용자가 클릭한 블록 번호 추가
		
		const arr = Array.from(set); // Set -> Array 변환
		
		const item = { number: arr.toString() }; // property : number, value : 중복없는 클릭한 블록 번호
		
		localStorage.setItem(key, JSON.stringify(item)); // localStorage에 저장

		if (arr.length == 10) { // 클릭한 블록 개수가 10개가 되면 /click 요청
			location.href="/click"; // db에 데이터 저장, 포인트 지급 alert 창 띄움
		}
	}
	
	$(document).ready(function() {
		topSize = 0;
		var listBGSeq = [[${blockGroupSeqList}]];
		var listBG
       var cImgList = encodeURI("[[${listcImg}]]");
       var cImgArr = cImgList.split(",");
       
       
       var cImgTopList = encodeURI("[[${listTopcImg}]]");
       var cImgTopArr = cImgTopList.split(",");
       
       for (var i = 1; i <= 5; i++) {
           document.getElementById("topImg"+i).src = cImgTopArr[i].slice(3);
           console.log(cImgTopArr[i].slice(3));
           if(i==5){
              document.getElementById("topImg"+i).src = cImgTopArr[i].slice(3).slice(0,-3);
           }
       }
       
       for (var i = 1; i <= listBGSeq.length; i++) {
          var child = "<div class='tt' id=" + i + "><img src='"+ cImgArr[i].slice(3) + "'/></div>";
          
          $(".blockTest").append(child);
          createBlock(i);

					if (i % 17 == 0) {
						// 				$("#" + i).css('margin-left', 100 * i + 'px');
						$("#" + i).css('margin-top', topSize + 'px');
						topSize += 100;
					} else {
						$("#" + i).css('margin-top', topSize + 'px');
					}

				}

       /*
				$("#12").css('z-index', '50');

				var xindex = parseInt($("#12").css('margin-left')); // 200
				var yindex = parseInt($("#12").css('margin-top')); // 30

				var changedxindex = xindex - 100; // 100
				var changedyindex = yindex; // 0

				$("#12").css('margin-left', changedxindex + 'px');
				$("#12").css('margin-top', changedyindex + 'px');
				$("#12").css('width', '300px');
				$("#12").css('height', '300px');
				$("#12").css('text-align', 'center');

				$("#11").css('z-index', '51');
				$("#13").css('z-index', '51');
				$("#45").css('z-index', '51');
				$("#47").css('z-index', '51');
		*/
			});
	</script>

	<th:block th:replace="/fragments/header :: TopbarFragment"></th:block>

	<!-- Carousel Start -->
	<div class="container-fluid p-0">
		<div id="header-carousel" class="carousel slide" data-ride="carousel">
			<div class="carousel-inner">
				<div class="carousel-item active">
					<img style="height: 500px;" id="topImg1" class="w-100"
						src="img/carousel-1.jpg" alt="Image">
					<div
						class="carousel-caption d-flex flex-column align-items-center justify-content-center">
						<div class="p-3" style="max-width: 900px;">
							<h4 class="text-white text-uppercase mb-md-3">Tours & Travel</h4>
							<h1 class="display-3 text-white mb-md-4">Let's Discover The
								World Together</h1>
							<a href="" class="btn btn-primary py-md-3 px-md-5 mt-2">Book
								Now</a>
						</div>
					</div>
				</div>
				<div class="carousel-item">
					<img style="height: 500px;" id="topImg2" class="w-100"
						src="img/carousel-2.jpg" alt="Image">
					<div
						class="carousel-caption d-flex flex-column align-items-center justify-content-center">
						<div class="p-3" style="max-width: 900px;">
							<h4 class="text-white text-uppercase mb-md-3">Tours & Travel</h4>
							<h1 class="display-3 text-white mb-md-4">Discover Amazing
								Places With Us</h1>
							<a href="" class="btn btn-primary py-md-3 px-md-5 mt-2">GO</a>
						</div>
					</div>
				</div>
				<div class="carousel-item">
					<img style="height: 500px;" id="topImg3" class="w-100"
						src="img/carousel-2.jpg" alt="Image">
					<div
						class="carousel-caption d-flex flex-column align-items-center justify-content-center">
						<div class="p-3" style="max-width: 900px;">
							<h4 class="text-white text-uppercase mb-md-3">Tours & Travel</h4>
							<h1 class="display-3 text-white mb-md-4">Discover Amazing
								Places With Us</h1>
							<a href="" class="btn btn-primary py-md-3 px-md-5 mt-2">GO</a>
						</div>
					</div>
				</div>
				<div class="carousel-item">
					<img style="height: 500px;" id="topImg4" class="w-100"
						src="img/carousel-2.jpg" alt="Image">
					<div
						class="carousel-caption d-flex flex-column align-items-center justify-content-center">
						<div class="p-3" style="max-width: 900px;">
							<h4 class="text-white text-uppercase mb-md-3">Tours & Travel</h4>
							<h1 class="display-3 text-white mb-md-4">Discover Amazing
								Places With Us</h1>
							<a href="" class="btn btn-primary py-md-3 px-md-5 mt-2">GO</a>
						</div>
					</div>
				</div>
				<div class="carousel-item">
					<img style="height: 500px;" id="topImg5" class="w-100"
						src="img/carousel-2.jpg" alt="Image">
					<div
						class="carousel-caption d-flex flex-column align-items-center justify-content-center">
						<div class="p-3" style="max-width: 900px;">
							<h4 class="text-white text-uppercase mb-md-3">Tours & Travel</h4>
							<h1 class="display-3 text-white mb-md-4">Discover Amazing
								Places With Us</h1>
							<a href="" class="btn btn-primary py-md-3 px-md-5 mt-2">GO</a>
						</div>
					</div>
				</div>
			</div>
			<a class="carousel-control-prev" href="#header-carousel"
				data-slide="prev">
				<div class="btn btn-dark" style="width: 45px; height: 45px;">
					<span class="carousel-control-prev-icon mb-n2"></span>
				</div>
			</a> <a class="carousel-control-next" href="#header-carousel"
				data-slide="next">
				<div class="btn btn-dark" style="width: 45px; height: 45px;">
					<span class="carousel-control-next-icon mb-n2"></span>
				</div>
			</a>
		</div>
	</div>
	<!-- Carousel End -->

	<div>
		<div>
			<br /> <br /> <br />
			<div class="col-lg-4 col-md-6 mb-4 pb-2 blockTest"></div>
			<!--     Blog End -->


			<!-- Footer Start -->
			<br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br />
			<br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br />
			<br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br />
			<br /> <br /> <br /> <br /> <br /> <br /> <br /> <br /> <br />
			<br />

		</div>
		<th:block th:replace="/fragments/footer :: footerFragment"></th:block>
	</div>
</body>

</html>