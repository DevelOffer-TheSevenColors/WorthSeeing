
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity5">

<head th:replace="/fragments/header :: head">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
</head>

<body>
	<div>
		<th:block th:replace="/fragments/header :: TopbarFragment"></th:block>

		<div class="container-fluid py-5">
			<div class="container pt-5 pb-3">

				<div id="title">
					<h2>1:1 문의 글</h2>
				</div>


				<form th:action="@{/notify/getContact}" method="post">
					<table class="getContact">
						<tr>
							<td th:text="제목" width="80"></td>
							<td><input name="notifySeq" type="hidden"
								th:value="${notify.notifySeq}"> <input name="title"
								type="text" th:value="${notify.title}"></td>
						</tr>
						<tr>
							<td th:text="작성자"></td>
							<td><span sec:authentication="principal.users.name"></span></td>
						</tr>
						<tr>
							<td th:text="내용">
							<td><textarea name="content" th:text="${notify.content}"
									cols="40" rows="10"></textarea></td>
						</tr>

						<tr>
							<td th:text="조회수"></td>
							<td th:text="${notify.viewCnt}"></td>
						</tr>

						<tr>
							<td th:text="등록일"></td>
							<td th:text="${#dates.format(notify.notifyTime, 'yyyy-MM-dd')}">
						</tr>

					</table>

				</form>

				<div class="aLink">
					<a th:if="${notify.users.name eq principal.users.name}"
						th:href="@{/notify/deleteNotifyProc(notifySeq=${notify.notifySeq})}">게시글
						삭제</a>
				</div>
				<div>
					<a th:href="@{/notify}">목록 이동</a>
				</div>


				<!-- 댓글 -->
				<table class="container-fluid py-5">
					<div class="container py-5">
						<div class="text-center mb-3 pb-3">
							<h6 class="text-primary text-uppercase"
								style="letter-spacing: 5px;">Reply</h6>
							<h3>댓글</h3>
						</div>
						<div class="row justify-content-center">
							<div class="col-lg-8">
								<div class="contact-form bg-white" style="padding: 30px;">
									<div id="success"></div>
									<form action="/reply/insertReplyProc" name="sentMessage"
										id="contactForm" novalidate="novalidate" method="post">
										<div class="form-row"></div>
										<div class="control-group">
											<p class="form-control p-4" id="name"
												th:text="${principal.users.name}"></p>
											<p class="help-block text-danger"></p>
										</div>
										<div class="control-group">
											<textarea class="form-control py-3 px-4" rows="5"
												name="replyContent" id="message" placeholder="Message"
												required="required"
												data-validation-required-message="Please enter your message"></textarea>
											<p class="help-block text-danger"></p>
										</div>
										<div class="text-center">
											<input value="댓글 등록" class="btn btn-primary py-3 px-4"
												type="submit" id="sendMessageButton" />
										</div>
										<input type="hidden" name="notifySeq"
											th:value="${notify.notifySeq}"> <input type="hidden"
											name="status_seq" th:value="${status_seq}">
									</form>
								</div>
							</div>
						</div>
					</div>
				</table>


				<!--댓글목록 -->
				<div class="bg-white" style="padding: 30px; margin-bottom: 30px;">
					<h4 class="text-uppercase mb-4" style="letter-spacing: 5px;">댓글</h4>
					<div class="media mb-4" th:each="reply, state : ${replyList}">
						<div class="media-body">
							<span th:text="${reply.replyer}"></span> <small><span
								th:text="${#dates.format(reply.replyDate, 'yyyy-MM-dd')}"></span></small>
							<div>
								<span th:text="${reply.replyContent}"></span>
							</div>
						</div>
					<div class="aLink">
						<a th:if="${reply.replyer == principal.users.name}"
							th:href="@{/reply/deleteReplyProc(replySeq=${reply.replySeq}, status_seq=${notify.status.status_seq}, notifySeq=${notify.notifySeq})}">댓글
							삭제</a>
					</div>
					</div>
				</div>

				<!-- 댓글 Paging -->
				<form th:action="@{/notify/getContact}" method="post">
					<input name="notifySeq" type="hidden"
						th:value="${notify.notifySeq}"> <input type="hidden"
						name="status_seq" th:value="${status_seq}">
					<div>
						<div th:if="${replyList.totalElements != 0}">
							<nav class="customNav">
								<ul class="customPagination"
									th:with="start=${(1-(replyList.number%1))%1 + 1},
	                    	last=(${start + 9 < replyList.totalPages ? start + 9 : replyList.totalPages})">

									<li th:class="${replyList.first} ? 'disabled'">
										<button name="page" value="1">First</button>
									</li>

									<li th:class="${replyList.first} ? 'disabled'">
										<button name="page" th:value="${replyList.number}">&lt;</button>
									</li>

									<li th:each="page : ${#numbers.sequence(start, last)}"
										th:class="${page == replyList.number + 1} ? 'active'">
										<button name="page" th:value="${page}" th:text="${page}"></button>
									</li>

									<li th:class="${replyList.last} ? 'disabled'">
										<button name="page" th:value="${replyList.number + 2}">&gt;</button>
									</li>

									<li th:class="${replyList.last} ? 'disabled'">
										<button name="page" th:value="${replyList.totalPages}">Last</button>
									</li>
								</ul>
							</nav>
						</div>

					</div>
					<!-- 					<p th:text="${notify.users.userId}" ></p> -->
					<!-- 					<p th:text="${principal.users.userId}" ></p> -->

					<div class="aLink">
						<a th:if="${notify.users.name == principal.users.userId}"
							th:href="@{/notify/deleteNotifyProc(notifySeq=${notify.notifySeq})}">문의글
							삭제</a>
					</div>


				</form>
			</div>
		</div>

		<th:block th:replace="/fragments/footer :: footerFragment"></th:block>
	</div>

</body>

</html>